############################################################
# Description: Places a gobblerift
# Creator: CreeperMagnet_
############################################################

tag @s add tcc.tag
execute if entity @s[y_rotation=-45..45] if entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[180.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable"],Silent:1b}
execute if entity @s[y_rotation=-45..45] unless entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[180.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable","tcc.gobblerift.custom_name"],Silent:1b}

execute if entity @s[y_rotation=45..135] if entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[270.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable"],Silent:1b}
execute if entity @s[y_rotation=45..135] unless entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[270.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable","tcc.gobblerift.custom_name"],Silent:1b}

execute if entity @s[y_rotation=135..-135] if entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[0.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable"],Silent:1b}
execute if entity @s[y_rotation=135..-135] unless entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[0.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable","tcc.gobblerift.custom_name"],Silent:1b}

execute if entity @s[y_rotation=-135..-45] if entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[90.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable"],Silent:1b}
execute if entity @s[y_rotation=-135..-45] unless entity @s[nbt={SelectedItem:{tag:{display:{Name:'{"italic":false,"color":"yellow","translate":"block.tcc.gobblerift"}'}}}}] run summon wandering_trader ~0.5 -500 ~0.5 {Team:"tcc.antivillager",Rotation:[90.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.start","tcc.gobblerift.bonemealable","tcc.gobblerift.custom_name"],Silent:1b}

execute unless entity @s run setblock ~ ~ ~ air
execute unless entity @s run summon wandering_trader ~ ~-0.5 ~ {Team:"tcc.antivillager",Rotation:[180.0f,0.0f],CustomName:'{"translate":"block.tcc.gobblerift"}',AbsorptionAmount:10e100f,DeathLootTable:"tcc:blocks/gobblerift",Offers:{Recipes:[]},DeathTime:19s,ArmorDropChances:[-10000.0f,-10000.0f,-10000.0f,-10000.0f],HandDropChances:[-10000.0f,-10000.0f],NoAI:1b,ActiveEffects:[{Id:14b,Duration:100000,Amplifier:0b,ShowParticles:0b}],HandItems:[{Count:1b,id:"minecraft:structure_block",tag:{tcc:{gobblerift_break_state:0},CustomModelData:330030}}],Health:0.01f,Tags:["tcc.block","tcc.entity","global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift","tcc.gobblerift.bonemealable","tcc.gobblerift.start","tcc.gobblerift.naturally_spawned"],Silent:1b}


execute if entity @s run summon item_frame ~ ~1 ~ {Item:{id:"minecraft:structure_block",Count:1b,tag:{CustomModelData:330030}},Facing:1b,Invulnerable:1b,Tags:["global.ignore","global.ignore.kill","global.ignore.pos","tcc.gobblerift.temp"],Silent:1b,Fixed:1b,Invisible:1b}
execute as @e[type=wandering_trader,limit=1,sort=nearest,tag=tcc.gobblerift.start] run function tcc:block/gobblerift/place/initiate
item entity @s[gamemode=!creative,nbt={Inventory:[{Slot:-106b,tag:{tcc:{id:"gobblerift"}}}]},nbt=!{SelectedItem:{tag:{tcc:{id:"gobblerift"}}}}] weapon.offhand replace air
item entity @s[gamemode=!creative,nbt={SelectedItem:{tag:{tcc:{id:"gobblerift"}}}}] weapon.mainhand replace air
scoreboard players reset @s tcc.dummy
playsound tcc:block.gobblerift.place block @a[distance=..16]
tag @s remove tcc.tag
